import{d as k,_ as $,o as n,c as t,e,t as d,F as _,i as S,j as r,u as I,k as j,r as D,h as i,l as V,v as L,m as N,p as B,g as F}from"./index-741b0eb6.js";import{a as b}from"./config-9d7f0f6c.js";const T=k({props:{submission:{type:Object,required:!0}}}),M={class:"mygrid-item opacity-75 p-7 rounded-xl shadow-md w-full md:w-1/3 lg:w-1/4 m-4"},U={class:"p-2"},q={class:"font-semibold"};function E(s,o,v,g,c,m){return n(),t("div",M,[e("div",U,[e("div",null," Submitted by "+d(s.submission.user_name),1),e("div",null," on "+d(s.submission.formatted_date)+" at "+d(s.submission.formatted_time),1)]),(n(!0),t(_,null,S(s.submission.fields,l=>(n(),t("div",{key:l.id,class:"p-2"},[e("div",q,d(l.title),1),e("div",null,d(l.value),1)]))),128))])}const O=$(T,[["render",E]]),R=k({components:{SubmissionCard:O},setup(){const s=r("forminder"),o=r(!0),v=r("csv"),g=r([]),c=r(1),m=r(10),l=r(1),h=I().query.formId,y=r(),C=()=>{const p=v.value==="csv"?b+"/api/v1/submissions/export/csv?formId="+h:b+"/api/v1/submissions/export/xlsx?formId="+h;window.location.href=p},w=async()=>{const p=await fetch(b+`/api/v1/submissions?formId=${h}&page=${c.value}&per_page=${m.value}`);if(o.value=!1,p.ok){const f=await p.json();y.value=f.form_name,g.value=f.submissions,l.value=Math.floor(f.total/m.value)+(f.total%m.value>0?1:0)}},P=p=>{c.value=p,w()};return j(()=>{w()}),{loading:o,formName:y,slashCommand:s,exportType:v,submissions:g,downloadData:C,page:c,lastPage:l,changePage:P}}});const u=s=>(B("data-v-6e37bc09"),s=s(),F(),s),X={key:0,class:"w-full text-3xl text-center p-5"},z={class:"text-3xl"},A={key:1,class:"loading-indicator"},G={class:"flex justify-around"},H={key:0},J=u(()=>e("span",null," Export as ",-1)),K=u(()=>e("option",{value:"csv"},"CSV",-1)),Q=u(()=>e("option",{value:"xlsx"},"XLSX",-1)),W=[K,Q],Y={class:"flex flex-wrap justify-center place-content-evenly"},Z={key:0,class:"mygrid-item opacity-75 p-7 rounded-xl shadow-md w-full md:w-1/3 lg:w-1/4 p-4"},x=u(()=>e("div",{class:"p-1"}," There are no submissions for this form. ",-1)),ss=u(()=>e("div",{class:"p-1"}," Schedule the form in slack by running: ",-1)),es={class:"p-1 code"},os=u(()=>e("div",{class:"p-1"},' and then pressing "Schedule". ',-1)),ns=u(()=>e("div",{class:"p-1"},' Or fill it without scheduling by pressing "Fill now". ',-1)),ts={key:0,class:"flex justify-center"},as={class:"m-3"},is={class:"p-3"};function ds(s,o,v,g,c,m){const l=D("SubmissionCard");return n(),t(_,null,[s.loading?i("",!0):(n(),t("div",X,[e("span",z,d(s.formName)+" - Submissions",1)])),s.loading?(n(),t("div",A," Loading... ")):i("",!0),e("div",null,[e("div",G,[s.loading?i("",!0):(n(),t("div",H,[J,V(e("select",{name:"export",id:"export",class:"p-2 m-1 rounded-md shadow","onUpdate:modelValue":o[0]||(o[0]=a=>s.exportType=a)},W,512),[[L,s.exportType]]),e("button",{id:"download-btn",class:"bg-greenish p-2 m-1 rounded",onClick:o[1]||(o[1]=(...a)=>s.downloadData&&s.downloadData(...a))}," Download ")]))]),e("div",Y,[(n(!0),t(_,null,S(s.submissions,a=>(n(),N(l,{key:a.id,submission:a},null,8,["submission"]))),128)),!s.loading&&!s.submissions.length?(n(),t("div",Z,[x,ss,e("div",es," /"+d(s.slashCommand)+" list ",1),os,ns])):i("",!0)]),s.loading?i("",!0):(n(),t("div",ts,[e("div",as,[s.page>1?(n(),t("button",{key:0,onClick:o[2]||(o[2]=a=>s.changePage(1)),class:"p-3 underline"}," First ")):i("",!0),s.page>1?(n(),t("button",{key:1,onClick:o[3]||(o[3]=a=>s.changePage(s.page-1)),class:"p-3 underline"}," Previous ")):i("",!0),e("span",is," Page "+d(s.page)+" of "+d(s.lastPage),1),s.page<s.lastPage?(n(),t("button",{key:2,onClick:o[4]||(o[4]=a=>s.changePage(s.page+1)),class:"p-3 underline"}," Next ")):i("",!0),s.page<s.lastPage?(n(),t("button",{key:3,onClick:o[5]||(o[5]=a=>s.changePage(s.lastPage)),class:"p-3 underline"}," Last ")):i("",!0)])]))])],64)}const us=$(R,[["render",ds],["__scopeId","data-v-6e37bc09"]]);export{us as default};
